<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>For My Fatouma ğŸ’–</title>
<style>
/* (same styles as before, trimmed here for brevity) */
*{margin:0;padding:0;box-sizing:border-box}
body{font-family:Georgia,serif;background:linear-gradient(135deg,#ffafbd 0%,#ffc3a0 100%);min-height:100vh;display:flex;flex-direction:column;align-items:center;padding:20px;color:#5a3d2b}
.container{max-width:400px;width:100%;text-align:center;margin:0 auto}
.heart-header{font-size:3rem;margin-bottom:20px;animation:float 3s ease-in-out infinite}
@keyframes float{0%,100%{transform:translateY(0)}50%{transform:translateY(-10px)}}
.message-card{background:rgba(255,255,255,.95);border-radius:20px;padding:30px;margin:20px 0;box-shadow:0 10px 30px rgba(0,0,0,.1);backdrop-filter:blur(10px);text-align:center}
h1{color:#e75480;margin-bottom:15px;font-size:1.8rem}
p{line-height:1.6;margin-bottom:15px;font-size:1.1rem}
.apology-text{font-style:italic;color:#666;margin:20px 0}
.cta-button{background:linear-gradient(135deg,#e75480 0%,#ff6b6b 100%);color:#fff;border:none;padding:15px 40px;border-radius:30px;font-size:1.2rem;cursor:pointer;margin:20px 0;transition:all .3s;box-shadow:0 5px 15px rgba(231,84,128,.3)}
.cta-button:hover{transform:translateY(-2px)}
.second-page{display:none}.second-page.show{display:block}
.sticker{font-size:8rem;margin:20px 0;animation:bounce 2s ease-in-out infinite}@keyframes bounce{0%,100%{transform:scale(1)}50%{transform:scale(1.1)}}
.question{font-size:1.5rem;color:#e75480;margin:12px 0;font-weight:bold}
.button-container{display:flex;flex-direction:column;gap:12px;margin-top:12px;align-items:center}
.yes-button{background:linear-gradient(135deg,#4CAF50 0%,#45a049 100%);color:#fff;border:none;padding:14px 36px;border-radius:30px;font-size:1.2rem;cursor:pointer;box-shadow:0 5px 15px rgba(76,175,80,.3);width:200px}
.no-button{background:linear-gradient(135deg,#ff6b6b 0%,#e75480 100%);color:#fff;border:none;padding:14px 36px;border-radius:30px;font-size:1.15rem;cursor:pointer;box-shadow:0 5px 15px rgba(255,107,107,.3);width:200px}
.footer{margin-top:18px;font-style:italic;color:#666;font-size:.95rem;text-align:left;width:100%;padding-left:10px}
.music-player{position:fixed;bottom:20px;right:20px;background:rgba(255,255,255,.9);padding:10px 15px;border-radius:25px;box-shadow:0 4px 15px rgba(0,0,0,.1);display:flex;align-items:center;gap:10px;z-index:1000;backdrop-filter:blur(10px)}
.music-control{background:#e75480;color:#fff;border:none;width:40px;height:40px;border-radius:50%;cursor:pointer;display:flex;align-items:center;justify-content:center;font-size:1.1rem}
.song-info{font-size:.8rem;color:#666;text-align:left}.song-title{font-weight:bold;color:#e75480}
.volume-control{width:80px;height:4px;background:#ddd;border-radius:2px;outline:none;-webkit-appearance:none}
@media(max-width:480px){.message-card{padding:20px}.sticker{font-size:6rem}.music-player{bottom:10px;right:10px;left:10px;justify-content:center}.yes-button,.no-button{width:90%;max-width:260px}}
</style>
</head>
<body>

<!-- MUSIC PLAYER -->
<div class="music-player" id="musicPlayer">
  <button class="music-control" id="playPauseBtn">â–¶ï¸</button>
  <div class="song-info">
    <div class="song-title">Ã‰lissa - Betrouh Betghib</div>
    <div id="audioStatus">Tap anywhere or press play ğŸ’–</div>
  </div>
  <input type="range" id="volumeControl" class="volume-control" min="0" max="1" step="0.1" value="0.3" />
</div>

<!-- FIRST PAGE -->
<div class="container first-page" id="firstPage">
  <div class="heart-header">ğŸ’–</div>
  <div class="message-card">
    <h1>My Dearest Fatouma</h1>
    <p>Every day without you feels incomplete. I've had so much time to reflect, and I realize how precious what we had truly was.</p>
    <p class="apology-text">I'm deeply sorry for the pain I caused. You are the most amazing person I've ever known, and I miss you more than words can express.</p>
    <p>Our memories together are treasures I hold close to my heart. The laughter, the dreams, the way your eyes light up when you smile...</p>
    <p>I believe in us, and I believe in the beautiful connection we shared. You are worth fighting for, and I'm willing to do whatever it takes to earn back your trust.</p>
    <p>Will you let me show you how much I've grown and how serious I am about us?</p>
  </div>
  <button class="cta-button" onclick="showSecondPage()">See What's in My Heart ğŸ’Œ</button>
  <div class="footer">Made with love, just for you</div>
</div>

<!-- SECOND PAGE -->
<div class="container second-page" id="secondPage">
  <div class="sticker">ğŸ¥°</div>
  <div class="message-card">
    <div class="horizontal-header">
      <div class="heart-icon">ğŸ’–</div>
      <h2>For My Fatouma</h2>
      <div class="heart-icon">ğŸ’–</div>
    </div>
    <p class="question">Will you go out on a first date with me?</p>
    <p>Let's create new beautiful memories together</p>
    <div class="button-container">
      <button class="yes-button" id="yesButton" onclick="sendWhatsAppMessage()">YES! ğŸ’</button>
      <button class="no-button" id="noButton" onclick="makeYesBigger()">No ğŸ˜”</button>
    </div>
  </div>
  <div class="footer">Our story isn't over yet...</div>
</div>

<!-- AUDIO (src will be set by JS: local first, then fallback to raw.githubusercontent.com) -->
<audio id="backgroundMusic" loop preload="auto" playsinline>
  <source id="audioSource" src="" type="audio/mpeg">
  Your browser does not support the audio element.
</audio>

<script>
const backgroundMusic = document.getElementById('backgroundMusic');
const audioSource = document.getElementById('audioSource');
const playPauseBtn = document.getElementById('playPauseBtn');
const volumeControl = document.getElementById('volumeControl');
const audioStatus = document.getElementById('audioStatus');

// Fallback URLs
const localFilename = 'elissa-song.mp3.mp3'; // file in repo root
const rawURL = 'https://raw.githubusercontent.com/zouaghif1/for-fatouma/main/elissa-song.mp3.mp3';

// Set initial volume
backgroundMusic.volume = 0.3;

// Try HEAD to see if local file exists; otherwise use raw URL
async function chooseAudioSource() {
  try {
    // Use HEAD request to check availability
    const res = await fetch(localFilename, { method: 'HEAD' });
    if (res.ok) {
      audioSource.src = localFilename;
      console.log('Using local audio file:', localFilename);
      audioStatus.textContent = 'Using local audio file';
    } else {
      audioSource.src = rawURL;
      console.log('Local not found, using raw URL:', rawURL);
      audioStatus.textContent = 'Using hosted audio file';
    }
  } catch (err) {
    // network error -> try raw URL
    audioSource.src = rawURL;
    console.log('Error checking local file, using raw URL:', err);
    audioStatus.textContent = 'Using hosted audio file (fallback)';
  } finally {
    backgroundMusic.load();
  }
}
chooseAudioSource();

// attempt to play on first user interaction (unlock on mobile)
function tryPlayMusic() {
  backgroundMusic.play().then(()=> {
    playPauseBtn.innerHTML = 'â¸ï¸';
    audioStatus.textContent = 'Playing ğŸ’–';
  }).catch((e)=>{
    playPauseBtn.innerHTML = 'â–¶ï¸';
    audioStatus.textContent = 'Tap play to listen';
    console.warn('Playback prevented until explicit play:', e);
  });
  document.removeEventListener('click', tryPlayMusic);
}
document.addEventListener('click', tryPlayMusic, { once: true });

// play/pause button
playPauseBtn.addEventListener('click', function(e){
  e.stopPropagation();
  if (backgroundMusic.paused) {
    backgroundMusic.play().then(()=> {
      playPauseBtn.innerHTML = 'â¸ï¸';
      audioStatus.textContent = 'Playing ğŸ’–';
    }).catch(()=> {
      playPauseBtn.innerHTML = 'â–¶ï¸';
      audioStatus.textContent = 'Playback blocked';
    });
  } else {
    backgroundMusic.pause();
    playPauseBtn.innerHTML = 'â–¶ï¸';
    audioStatus.textContent = 'Paused';
  }
});

// volume
volumeControl.addEventListener('input', function(){ backgroundMusic.volume = this.value; });

// page controls
function showSecondPage(){
  document.getElementById('firstPage').style.display = 'none';
  document.getElementById('secondPage').classList.add('show');
  window.scrollTo({ top:0, behavior:'smooth' });
}

function makeYesBigger(){
  const yesButton = document.getElementById('yesButton');
  const noButton = document.getElementById('noButton');
  const currentSize = parseFloat(window.getComputedStyle(yesButton).fontSize) || 20;
  yesButton.style.fontSize = (currentSize + 3) + 'px';
  yesButton.style.padding = '18px 46px';
  const messages = ["Are you sure? ğŸ¥º","Pretty please? ğŸ’•","Think about our memories! ğŸŒ¸","I really mean it this time! âœ¨","You're my everything! ğŸ’«","I'll never give up on us! ğŸ’–","Give me one more chance? ğŸŒ¹","My heart is yours forever ğŸ’Œ"];
  noButton.textContent = messages[Math.floor(Math.random()*messages.length)];
}

function sendWhatsAppMessage(){
  const yourPhoneNumber = '21696689103';
  const message = "I will give you a second chance ğŸ’–";
  window.open(`https://wa.me/${yourPhoneNumber}?text=${encodeURIComponent(message)}`, '_blank');
  document.querySelector('.sticker').textContent = 'ğŸ‰ğŸ’ğŸŠ';
  document.querySelector('.question').innerHTML = "You've made me the happiest person!<br>Check your WhatsApp! ğŸ’Œ";
  document.querySelector('.button-container').innerHTML = `<div style="color:#4CAF50;font-size:1.15rem;margin:18px 0;text-align:center">ğŸ’ Thank you for this chance! âœ¨</div>`;
}

// floating hearts (unchanged)
setInterval(function(){
  const heart = document.createElement('div');
  heart.innerHTML = 'ğŸ’–';
  heart.style.position = 'fixed';
  heart.style.left = Math.random()*100 + 'vw';
  heart.style.top = '100vh';
  heart.style.fontSize = (Math.random()*20+10) + 'px';
  heart.style.opacity = '0.7';
  heart.style.pointerEvents = 'none';
  heart.style.zIndex = '9999';
  heart.style.animation = `floatUp ${Math.random()*3+2}s linear forwards`;
  document.body.appendChild(heart);
  setTimeout(()=>heart.remove(), 5000);
}, 3000);

const style = document.createElement('style');
style.textContent = `@keyframes floatUp {0%{transform:translateY(0) rotate(0deg);opacity:0.7}100%{transform:translateY(-100vh) rotate(360deg);opacity:0}}`;
document.head.appendChild(style);
</script>
</body>
</html>
